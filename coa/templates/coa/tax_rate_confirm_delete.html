{% extends 'base.html' %}
{% load static %}

{% block title %}Delete Tax Rate{% endblock %}

{% block extra_css %}
<style>
  .danger-card {
    border: 2px solid #dc3545;
    border-radius: 0.5rem;
    max-width: 600px;
  }
  .danger-icon {
    font-size: 3rem;
    color: #dc3545;
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="d-flex align-items-center mb-3">
    <a href="{% url 'coa:tax_rates' %}" class="btn btn-outline-secondary me-3">
      <i class="bi bi-arrow-left"></i>
    </a>
    <h5 class="mb-0">Delete Tax Rate</h5>
    {% if active_company %}
      <small class="text-muted ms-auto">Company: {{ active_company.name }}</small>
    {% endif %}
  </div>

  <div class="card danger-card mx-auto">
    <div class="card-body text-center">
      <i class="bi bi-exclamation-triangle danger-icon mb-3"></i>
      
      <h5 class="card-title text-danger">Delete Tax Rate</h5>
      
      <p class="card-text mb-4">
        Are you sure you want to delete the tax rate 
        <strong>"{{ object.name }}"</strong> ({{ object.rate|floatformat:2 }}%)?
      </p>

      <div class="alert alert-warning text-start mb-4">
        <div class="d-flex">
          <i class="bi bi-info-circle me-2 mt-1"></i>
          <div>
            <strong>This action cannot be undone.</strong>
            <ul class="mb-0 mt-2">
              <li>The tax rate will be permanently removed</li>
              <li>This will not affect existing transactions</li>
              <li>Accounts using this tax rate will need a new tax rate assigned</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Tax Rate Details -->
      <div class="row text-start mb-4">
        <div class="col-sm-4 text-muted">Name:</div>
        <div class="col-sm-8">{{ object.name }}</div>
        
        <div class="col-sm-4 text-muted">Rate:</div>
        <div class="col-sm-8">{{ object.rate|floatformat:2 }}%</div>
        
        {% if object.tax_type %}
        <div class="col-sm-4 text-muted">Type:</div>
        <div class="col-sm-8">{{ object.get_tax_type_display }}</div>
        {% endif %}
        
        {% if object.tax_authority %}
        <div class="col-sm-4 text-muted">Authority:</div>
        <div class="col-sm-8">{{ object.tax_authority }}</div>
        {% endif %}
        
        {% if object.description %}
        <div class="col-sm-4 text-muted">Description:</div>
        <div class="col-sm-8">{{ object.description|truncatechars:100 }}</div>
        {% endif %}
        
        <div class="col-sm-4 text-muted">Created:</div>
        <div class="col-sm-8">{{ object.created_at|date:"M j, Y" }}</div>
      </div>

      <form method="post" class="d-inline-block">
        {% csrf_token %}
        <div class="d-flex gap-2 justify-content-center">
          <button type="submit" class="btn btn-danger">
            <i class="bi bi-trash me-1"></i>
            Yes, Delete Tax Rate
          </button>
          <a href="{% url 'coa:tax_rates' %}" class="btn btn-outline-secondary">
            <i class="bi bi-x me-1"></i>
            Cancel
          </a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  // Add confirmation on form submit for extra safety
  document.querySelector('form').addEventListener('submit', function(e) {
    if (!confirm('Are you absolutely sure you want to delete this tax rate? This action cannot be undone.')) {
      e.preventDefault();
    }
  });
</script>
{% endblock %}

{% extends 'base.html' %}
{% load static %}

{% block title %}Five-Tier Payment Allocation Setup - {{ company.name }}{% endblock %}

{% block extra_css %}
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'Segoe UI', sans-serif; font-size: 11pt; color: #201F1E; background: #F0F0F0; line-height: 1.4; }
  .page-wrapper { min-height: 100vh; display: flex; flex-direction: column; background: #F0F0F0; }
  .unified-header { background: linear-gradient(135deg, #4472C4 0%, #2B579A 100%); border-bottom: 3px solid #1F4788; padding: 16px 24px; display: flex; align-items: center; justify-content: space-between; gap: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
  .header-title-section h2 { margin: 0; font-size: 20px; font-weight: 600; color: white; }
  .company-name { font-size: 12px; opacity: 0.85; color: rgba(255, 255, 255, 0.95); margin: 0; }
  .balance-grid { display: flex; align-items: stretch; gap: 12px; flex: 1; justify-content: flex-end; }
  .balance-item { padding: 10px 16px; background: white; display: flex; flex-direction: column; align-items: center; min-width: 140px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); border: 1px solid rgba(255, 255, 255, 0.2); }
  .balance-item:first-child { border-left: 3px solid #4472C4; }
  .balance-item:nth-child(2) { border-left: 3px solid #4472C4; }
  .balance-item:nth-child(3) { border-left: 3px solid #107C10; }
  .balance-item:nth-child(4) { border-left: 3px solid #CA5010; }
  .balance-item:nth-child(5) { border-left: 3px solid #4472C4; }
  .balance-label { font-size: 9px; color: #605E5C; margin-bottom: 4px; font-weight: 700; text-transform: uppercase; text-align: center; }
  .balance-value { font-size: 18px; font-weight: 700; font-family: Consolas, monospace; color: #201F1E; }
  .header-actions { display: flex; gap: 8px; }
  .header-actions a { background: white; color: #4472C4; border: none; padding: 8px 16px; font-size: 11pt; font-weight: 600; cursor: pointer; text-decoration: none; }
  .header-actions a:hover { background: #F3F2F1; }
  .content-area { flex: 1; padding: 20px; max-width: 1800px; margin: 0 auto; width: 100%; }
  .two-col-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
  .excel-card { background: white; border: 1px solid #D2D0CE; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
  .excel-card-header { padding: 14px 18px; background: #F3F2F1; border-bottom: 2px solid #4472C4; font-size: 12pt; font-weight: 600; color: #323130; }
  .excel-card-body { padding: 18px; }
  .alert-box { padding: 12px 16px; margin-bottom: 16px; border-left: 4px solid; font-size: 10pt; }
  .alert-info { background: #DEECF9; border-left-color: #4472C4; color: #323130; }
  .alert-success { background: #DFF6DD; border-left-color: #107C10; color: #323130; }
  .alert-warning { background: #FFF4CE; border-left-color: #CA5010; color: #323130; }
  .alert-danger { background: #FDE7E9; border-left-color: #D83B01; color: #323130; }
  .config-section { background: white; border: 1px solid #D2D0CE; margin-bottom: 16px; }
  .config-header { padding: 12px 16px; font-size: 10pt; font-weight: 600; background: #F3F2F1; border-bottom: 2px solid; color: #323130; }
  .config-header.danger { border-bottom-color: #D83B01; }
  .config-header.primary { border-bottom-color: #4472C4; }
  .config-header.success { border-bottom-color: #107C10; }
  .config-header.warning { border-bottom-color: #CA5010; }
  .config-header.info { border-bottom-color: #4472C4; }
  .config-body { padding: 16px; }
  .form-group { margin-bottom: 12px; }
  .form-label { display: block; font-weight: 600; margin-bottom: 6px; font-size: 10pt; color: #323130; }
  select { width: 100%; padding: 8px 12px; border: 1px solid #D2D0CE; font-size: 11pt; font-family: 'Segoe UI', sans-serif; }
  select:focus { outline: none; border-color: #4472C4; }
  .form-text { font-size: 10pt; color: #605E5C; margin-top: 6px; line-height: 1.5; }
  .badge { display: inline-block; padding: 3px 8px; font-size: 9pt; font-weight: 600; text-transform: uppercase; }
  .badge-danger { background: #FDE7E9; color: #D83B01; border: 1px solid #D83B01; }
  .badge-success { background: #DFF6DD; color: #107C10; border: 1px solid #107C10; }
  .badge-info { background: #DEECF9; color: #4472C4; border: 1px solid #4472C4; }
  .badge-warning { background: #FFF4CE; color: #CA5010; border: 1px solid #CA5010; }
  .btn { padding: 10px 20px; border: 1px solid #D2D0CE; font-size: 11pt; font-weight: 600; cursor: pointer; text-decoration: none; display: inline-block; }
  .btn-primary { background: #4472C4; color: white; border-color: #4472C4; }
  .btn-primary:hover { background: #2B579A; }
  .btn-warning { background: #CA5010; color: white; border-color: #CA5010; }
  .btn-warning:hover { background: #A44109; }
  .btn-outline { background: white; color: #4472C4; }
  .btn-outline:hover { background: #4472C4; color: white; }
  .balance-display { text-align: center; padding: 12px; background: #F8F9FA; margin-top: 8px; border: 1px solid #EDEBE9; }
  .balance-display-value { font-size: 18px; font-weight: 700; font-family: Consolas, monospace; }
  .status-indicator { display: inline-block; padding: 4px 8px; font-size: 9pt; font-weight: 600; margin-top: 4px; }
  .config-info-list { list-style: none; padding: 0; }
  .config-info-item { padding: 12px; border-bottom: 1px solid #EDEBE9; display: flex; align-items: flex-start; gap: 12px; }
  .config-info-item:last-child { border-bottom: none; }
  .config-info-icon { font-size: 16px; flex-shrink: 0; }
  .config-info-content { flex: 1; }
  .config-info-label { font-weight: 600; font-size: 10pt; color: #323130; margin-bottom: 4px; }
  .config-info-value { font-size: 10pt; color: #323130; }
  .config-info-balance { font-size: 9pt; color: #605E5C; margin-top: 2px; }
  @media (max-width: 1024px) { .two-col-grid { grid-template-columns: 1fr; } }
</style>
{% endblock %}

{% block content %}
<div class="page-wrapper">
  <div class="unified-header">
    <div class="header-title-section">
      <h2>⚙️ Five-Tier Payment Allocation Setup</h2>
      <p class="company-name">{{ company.name }}</p>
    </div>
    
    <div class="balance-grid">
      {% if config.general_loans_receivable_account %}
      <div class="balance-item">
        <div class="balance-label">Main Engine</div>
        <div class="balance-value">${{ config.general_loans_receivable_account.current_balance|floatformat:2 }}</div>
      </div>
      {% endif %}
      {% if config.principal_account %}
      <div class="balance-item">
        <div class="balance-label">Principal</div>
        <div class="balance-value">${{ config.principal_account.current_balance|floatformat:2 }}</div>
      </div>
      {% endif %}
      {% if config.interest_income_account %}
      <div class="balance-item">
        <div class="balance-label">Interest</div>
        <div class="balance-value">${{ config.interest_income_account.current_balance|floatformat:2 }}</div>
      </div>
      {% endif %}
      {% if config.late_fee_income_account %}
      <div class="balance-item">
        <div class="balance-label">Late Fee</div>
        <div class="balance-value">${{ config.late_fee_income_account.current_balance|floatformat:2 }}</div>
      </div>
      {% endif %}
      {% if config.general_loan_disbursements_account %}
      <div class="balance-item">
        <div class="balance-label">Disbursements</div>
        <div class="balance-value">${{ config.general_loan_disbursements_account.current_balance|floatformat:2 }}</div>
      </div>
      {% endif %}
    </div>
    
    <div class="header-actions">
      <a href="/coa/" target="_blank">Chart of Accounts</a>
    </div>
  </div>

  <div class="content-area">
    <div class="two-col-grid">

  <div class="content-area">
    <div class="two-col-grid">
      <div>
        <div class="excel-card">
          <div class="excel-card-header">⚙️ Configurable Five-Tier Payment System</div>
          <div class="excel-card-body">
            
            <div class="alert-box alert-info" style="margin-bottom: 20px;">
              <strong>Need to view available accounts?</strong><br>
              Access your company's Chart of Accounts to see all available GL accounts with balances.
              <a href="/coa/" target="_blank" class="btn btn-outline" style="margin-top: 8px; font-size: 10pt; padding: 6px 12px;">Chart of Accounts</a>
            </div>

            {% if config and config.general_loans_receivable_account and config.principal_account and config.interest_income_account and config.late_fee_income_account and config.general_loan_disbursements_account %}
              <div class="alert-box alert-success">
                <strong>✅ Complete five-tier payment allocation configured!</strong>
                <div style="margin-top: 8px; font-size: 10pt;">
                  <div>✅ General Loans Receivable: {{ config.general_loans_receivable_account.code }} - {{ config.general_loans_receivable_account.name }}</div>
                  <div>✅ Principal: {{ config.principal_account.code }} - {{ config.principal_account.name }}</div>
                  <div>✅ Interest: {{ config.interest_income_account.code }} - {{ config.interest_income_account.name }}</div>
                  <div>✅ Late Fee: {{ config.late_fee_income_account.code }} - {{ config.late_fee_income_account.name }}</div>
                  <div>✅ Loan Disbursements: {{ config.general_loan_disbursements_account.code }} - {{ config.general_loan_disbursements_account.name }}</div>
                </div>
              </div>
            {% elif config and config.general_loans_receivable_account and config.principal_account and config.interest_income_account and config.late_fee_income_account %}
              <div class="alert-box alert-warning">
                <strong>⚠️ Four-Tier Complete</strong> - Add General Loan Disbursements account for full five-tier auto-matching system.
                <div style="margin-top: 8px; font-size: 10pt;">
                  <div>✅ General Loans Receivable: {{ config.general_loans_receivable_account.code }} - {{ config.general_loans_receivable_account.name }}</div>
                  <div>✅ Principal: {{ config.principal_account.code }} - {{ config.principal_account.name }}</div>
                  <div>✅ Interest: {{ config.interest_income_account.code }} - {{ config.interest_income_account.name }}</div>
                  <div>✅ Late Fee: {{ config.late_fee_income_account.code }} - {{ config.late_fee_income_account.name }}</div>
                  <div>⚠️ Loan Disbursements: Not configured</div>
                </div>
              </div>
            {% elif config and config.general_loans_receivable_account %}
              <div class="alert-box alert-warning">
                <strong>⚠️ Partial Configuration</strong> - Please configure all five accounts for complete allocation system.
              </div>
            {% else %}
              <div class="alert-box alert-info">
                <strong>ℹ️ Setup Required</strong> - Configure your five-tier payment allocation system below.
              </div>
            {% endif %}

            <form method="post" style="margin-top: 20px;">
            <form method="post" style="margin-top: 20px;">
                                {% csrf_token %}
                                
                                <!-- General Loans Receivable Account (Main Engine) -->
                                <div class="config-section">
                                  <div class="config-header danger">
                                    1. General Loans Receivable Account (Main Engine)
                                  </div>
                                  <div class="config-body">
                                    <div class="form-group">
                                      <label for="{{ form.general_loans_receivable_account.id_for_label }}" class="form-label">
                                        General Loans Receivable Account <span class="badge badge-danger">MAIN ENGINE</span>
                                      </label>
                                      {{ form.general_loans_receivable_account }}
                                      <div class="form-text">
                                        <strong>This is the main account that creates Payment records via reconciliation.</strong><br>
                                        <strong>Recommended:</strong> 122000 - General Loans Receivable<br>
                                        All loan payments from bank statements flow through this account.
                                      </div>
                                    </div>
                                    {% if config.general_loans_receivable_account %}
                                    <div class="balance-display">
                                      <div style="font-size: 10pt; color: #605E5C; margin-bottom: 4px;">Current Balance</div>
                                      <div class="balance-display-value" style="color: #D83B01;">${{ config.general_loans_receivable_account.current_balance|floatformat:2 }}</div>
                                      <div class="status-indicator badge-success">Payment Engine ACTIVE</div>
                                    </div>
                                    {% else %}
                                    <div class="balance-display" style="background: #FFF4CE;">
                                      <div style="color: #CA5010; font-weight: 600;">Payment Engine DISABLED</div>
                                    </div>
                                    {% endif %}
                                    {% if form.general_loans_receivable_account.errors %}
                                    <div class="alert-box alert-danger" style="margin-top: 12px;">
                                      {{ form.general_loans_receivable_account.errors.0 }}
                                    </div>
                                    {% endif %}
                                  </div>
                                </div>

                                <!-- Principal Allocation Account -->
                                <div class="config-section">
                                  <div class="config-header primary">
                                    2. Principal Allocation Account
                                  </div>
                                  <div class="config-body">
                                    <div class="form-group">
                                      <label for="{{ form.principal_account.id_for_label }}" class="form-label">
                                        Principal Allocation Account
                                      </label>
                                      {{ form.principal_account }}
                                      <div class="form-text">
                                        Account for principal portion during manager-approved splits.<br>
                                        <strong>Tip:</strong> Can be same as General Loans Receivable or separate account.
                                      </div>
                                    </div>
                                    {% if config.principal_account %}
                                    <div class="balance-display">
                                      <div style="font-size: 10pt; color: #605E5C; margin-bottom: 4px;">Current Balance</div>
                                      <div class="balance-display-value" style="color: #4472C4;">${{ config.principal_account.current_balance|floatformat:2 }}</div>
                                    </div>
                                    {% endif %}
                                    {% if form.principal_account.errors %}
                                    <div class="alert-box alert-danger" style="margin-top: 12px;">
                                      {{ form.principal_account.errors.0 }}
                                    </div>
                                    {% endif %}
                                  </div>
                                </div>

                                <!-- Interest Income Account -->
                                <div class="config-section">
                                  <div class="config-header success">
                                    3. Interest Income Account
                                  </div>
                                  <div class="config-body">
                                    <div class="form-group">
                                      <label for="{{ form.interest_income_account.id_for_label }}" class="form-label">
                                        Interest Income Account
                                      </label>
                                      {{ form.interest_income_account }}
                                      <div class="form-text">
                                        Revenue account for interest portion of payments.<br>
                                        <strong>Recommended:</strong> 4200 - Interest Income
                                      </div>
                                    </div>
                                    {% if config.interest_income_account %}
                                    <div class="balance-display">
                                      <div style="font-size: 10pt; color: #605E5C; margin-bottom: 4px;">Current Balance</div>
                                      <div class="balance-display-value" style="color: #107C10;">${{ config.interest_income_account.current_balance|floatformat:2 }}</div>
                                    </div>
                                    {% endif %}
                                    {% if form.interest_income_account.errors %}
                                    <div class="alert-box alert-danger" style="margin-top: 12px;">
                                      {{ form.interest_income_account.errors.0 }}
                                    </div>
                                    {% endif %}
                                  </div>
                                </div>

                                <!-- Late Fee Income Account -->
                                <div class="config-section">
                                  <div class="config-header warning">
                                    4. Late Fee Income Account
                                  </div>
                                  <div class="config-body">
                                    <div class="form-group">
                                      <label for="{{ form.late_fee_income_account.id_for_label }}" class="form-label">
                                        Late Fee Income Account
                                      </label>
                                      {{ form.late_fee_income_account }}
                                      <div class="form-text">
                                        Revenue account for late fee portion of payments.<br>
                                        <strong>Recommended:</strong> 4250 - Late Fee Income
                                      </div>
                                    </div>
                                    {% if config.late_fee_income_account %}
                                    <div class="balance-display">
                                      <div style="font-size: 10pt; color: #605E5C; margin-bottom: 4px;">Current Balance</div>
                                      <div class="balance-display-value" style="color: #CA5010;">${{ config.late_fee_income_account.current_balance|floatformat:2 }}</div>
                                    </div>
                                    {% endif %}
                                    {% if form.late_fee_income_account.errors %}
                                    <div class="alert-box alert-danger" style="margin-top: 12px;">
                                      {{ form.late_fee_income_account.errors.0 }}
                                    </div>
                                    {% endif %}
                                  </div>
                                </div>

                                <!-- General Loan Disbursements Account -->
                                <div class="config-section">
                                  <div class="config-header info">
                                    5. General Loan Disbursements Account (Auto-Match)
                                  </div>
                                  <div class="config-body">
                                    <div class="form-group">
                                      <label for="{{ form.general_loan_disbursements_account.id_for_label }}" class="form-label">
                                        General Loan Disbursements Account <span class="badge badge-info">AUTO-MATCH</span>
                                      </label>
                                      {{ form.general_loan_disbursements_account }}
                                      <div class="form-text">
                                        <strong>Account for automatic loan disbursement detection and matching.</strong><br>
                                        <strong>Recommended:</strong> 1250 - General Loan Disbursements<br>
                                        System will auto-match transactions like "EB-зээл олгов" to this account.
                                      </div>
                                    </div>
                                    {% if config.general_loan_disbursements_account %}
                                    <div class="balance-display">
                                      <div style="font-size: 10pt; color: #605E5C; margin-bottom: 4px;">Current Balance</div>
                                      <div class="balance-display-value" style="color: #4472C4;">${{ config.general_loan_disbursements_account.current_balance|floatformat:2 }}</div>
                                      <div class="status-indicator badge-success">Auto-Match ACTIVE</div>
                                    </div>
                                    {% else %}
                                    <div class="balance-display" style="background: #FFF4CE;">
                                      <div style="color: #CA5010; font-weight: 600;">Auto-Match DISABLED</div>
                                    </div>
                                    {% endif %}
                                    {% if form.general_loan_disbursements_account.errors %}
                                    <div class="alert-box alert-danger" style="margin-top: 12px;">
                                      {{ form.general_loan_disbursements_account.errors.0 }}
                                    </div>
                                    {% endif %}
                                  </div>
                                </div>

                                <!-- Save Button -->
                                <div style="text-align: right; margin-top: 20px;">
                                  <button type="submit" class="btn btn-primary">
                                    Save Configuration
                                  </button>
                                </div>
                            </form>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Current Configuration Panel -->
                <div>
                    {% if config %}
                    <div class="excel-card">
                        <div class="excel-card-header">Current Configuration</div>
                        <div class="excel-card-body">
                            <ul class="config-info-list">
                            {% if config.general_loans_receivable_account %}
                            <li class="config-info-item">
                              <div class="config-info-icon">⚙️</div>
                              <div class="config-info-content">
                                <div class="config-info-label">Main Engine:</div>
                                <div class="config-info-value">{{ config.general_loans_receivable_account.code }} - {{ config.general_loans_receivable_account.name }}</div>
                                <div class="config-info-balance">Balance: ${{ config.general_loans_receivable_account.current_balance|floatformat:2 }}</div>
                                <div class="badge badge-success" style="margin-top: 4px;">Payment Engine Active</div>
                              </div>
                            </li>
                            {% endif %}
                            
                            {% if config.principal_account %}
                            <li class="config-info-item">
                              <div class="config-info-icon">💰</div>
                              <div class="config-info-content">
                                <div class="config-info-label">Principal:</div>
                                <div class="config-info-value">{{ config.principal_account.code }} - {{ config.principal_account.name }}</div>
                                <div class="config-info-balance">Balance: ${{ config.principal_account.current_balance|floatformat:2 }}</div>
                              </div>
                            </li>
                            {% endif %}
                            
                            {% if config.interest_income_account %}
                            <li class="config-info-item">
                              <div class="config-info-icon">�</div>
                              <div class="config-info-content">
                                <div class="config-info-label">Interest Income:</div>
                                <div class="config-info-value">{{ config.interest_income_account.code }} - {{ config.interest_income_account.name }}</div>
                                <div class="config-info-balance">Balance: ${{ config.interest_income_account.current_balance|floatformat:2 }}</div>
                              </div>
                            </li>
                            {% endif %}
                            
                            {% if config.late_fee_income_account %}
                            <li class="config-info-item">
                              <div class="config-info-icon">⚠️</div>
                              <div class="config-info-content">
                                <div class="config-info-label">Late Fee Income:</div>
                                <div class="config-info-value">{{ config.late_fee_income_account.code }} - {{ config.late_fee_income_account.name }}</div>
                                <div class="config-info-balance">Balance: ${{ config.late_fee_income_account.current_balance|floatformat:2 }}</div>
                              </div>
                            </li>
                            {% endif %}
                            
                            {% if config.general_loan_disbursements_account %}
                            <li class="config-info-item">
                              <div class="config-info-icon">💸</div>
                              <div class="config-info-content">
                                <div class="config-info-label">Loan Disbursements:</div>
                                <div class="config-info-value">{{ config.general_loan_disbursements_account.code }} - {{ config.general_loan_disbursements_account.name }}</div>
                                <div class="config-info-balance">Balance: ${{ config.general_loan_disbursements_account.current_balance|floatformat:2 }}</div>
                                <div class="badge badge-success" style="margin-top: 4px;">Auto-Match Active</div>
                              </div>
                            </li>
                            {% endif %}
                            </ul>
                            
                            <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid #EDEBE9; font-size: 10pt; color: #605E5C;">
                              Last updated: {% if config.updated_at %}{{ config.updated_at|date:"M d, Y g:i A" }}{% else %}Never{% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <!-- Split Approval Reset Section -->
                    <div class="excel-card" style="border: 2px solid #CA5010;">
                        <div class="excel-card-header" style="background: #FFF4CE; color: #323130; border-bottom-color: #CA5010;">
                          Unapprove Split Transactions
                        </div>
                        <div class="excel-card-body">
                            <div class="alert-box alert-warning">
                                <strong>Reset Split Approvals</strong>
                                <p style="margin-top: 8px; margin-bottom: 8px;">
                                    This will unapprove all split transactions and reset the GL account balances for:
                                </p>
                                <ul style="margin-left: 20px; margin-bottom: 8px; font-size: 10pt;">
                                    <li><strong>Principal Allocation Account</strong> - Balance will be recalculated</li>
                                    <li><strong>Interest Income Account</strong> - Balance will be recalculated</li>
                                    <li><strong>Late Fee Income Account</strong> - Balance will be recalculated</li>
                                </ul>
                                <p style="font-size: 10pt; color: #605E5C; margin-bottom: 0;">
                                    Note: General Loans Receivable Account will NOT be affected by this reset.
                                    All payments will become approval-ready again.
                                </p>
                            </div>
                            
                            <form method="post" action="{% url 'loan_reconciliation_bridge:reset_split_approvals' %}" style="margin-top: 12px;">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-warning" style="width: 100%;"
                                        onclick="return confirm('Are you sure you want to reset all split approvals? This will:\n\n• Delete all SPLIT-PAY journal entries\n• Reset GL account balances (Principal, Interest, Late Fee)\n• Make all payments approval-ready again\n\nThis action cannot be undone!')">
                                    Reset All Split Approvals
                                </button>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Help Panel -->
                    <div class="excel-card">
                        <div class="excel-card-header">System Overview</div>
                        <div class="excel-card-body" style="font-size: 10pt;">
                            <div class="alert-box alert-info" style="margin-bottom: 16px;">
                                <div style="font-weight: 600; margin-bottom: 8px;">Chart of Accounts Access</div>
                                <div style="margin-bottom: 8px;">View your company's separated COA with account balances:</div>
                                <a href="/coa/" target="_blank" class="btn btn-outline" style="width: 100%; font-size: 10pt; padding: 8px;">
                                  Chart of Accounts
                                </a>
                            </div>
                            
                            <div style="border-top: 1px solid #EDEBE9; padding-top: 16px;">
                                <div style="margin-bottom: 8px;">
                                    <strong>Main Engine:</strong> Creates Payment records from bank reconciliation
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <strong>Principal:</strong> Receives principal portion during splits
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <strong>Interest:</strong> Receives interest portion during splits
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <strong>Late Fee:</strong> Receives late fee portion during splits
                                </div>
                                <div style="margin-bottom: 0;">
                                    <strong>Disbursements:</strong> Auto-matches loan disbursement transactions
                                </div>
                            </div>
                        </div>
                    </div>
                    {% else %}
                    <div class="excel-card">
                        <div class="excel-card-body" style="text-align: center; padding: 40px 20px;">
                            <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;">⚙️</div>
                            <h6 style="font-weight: 600; margin-bottom: 8px;">No Configuration Found</h6>
                            <p style="font-size: 10pt; color: #8A8886;">Please configure your five-tier payment allocation system using the form.</p>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
